; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env:Unified]
lib_deps = 
    nrf24/RF24@^1.4.8
    Wire
    symlink://third_party/SparkFun_ICM-20948_ArduinoLibrary
platform = teensy
board = teensy40
framework = arduino
build_src_filter = 
    +<*>
    -<Test/*.cc>
build_flags = 
    -D SEREMU_INTERFACE
    -I../Common
monitor_speed = 460800

[env:Transmitter]
extends = env:Unified
build_flags =
    -D USB_RAWHID
    -D SEREMU_INTERFACE
    -D FORCE_TX_FIRMWARE
    -I../Common

[env:Receiver]
extends = env:Unified
build_flags =
    -D FORCE_RX_FIRMWARE
    -I../Common
build_src_filter = 
    +<*>
    -<Test/*.cc>
    -<Transmitter/Transmitter.cpp>

[env:Receiver_Drive_Left]
extends = env:Unified
build_flags =
    -D FORCE_RX_DRIVE_LEFT_FIRMWARE
    -I../Common
build_src_filter = 
    +<*>
    -<Test/*.cc>
    -<Transmitter/Transmitter.cpp>

[env:Receiver_Wep_Front]
extends = env:Unified
build_flags =
    -D FORCE_RX_WEP_FRONT_FIRMWARE
    -I../Common
build_src_filter = 
    +<*>
    -<Test/*.cc>
    -<Transmitter/Transmitter.cpp>

[env:Receiver_Wep_Rear]
extends = env:Unified
build_flags =
    -D FORCE_RX_WEP_REAR_FIRMWARE
    -I../Common
build_src_filter = 
    +<*>
    -<Test/*.cc>
    -<Transmitter/Transmitter.cpp>


[env:Receiver_Drive_Right]
extends = env:Unified
build_flags =
    -D FORCE_RX_DRIVE_RIGHT_FIRMWARE
    -I../Common
build_src_filter = 
    +<*>
    -<Test/*.cc>
    -<Transmitter/Transmitter.cpp>

[env:All]
extends = env:Unified
build_flags =
    -D USB_RAWHID
    -D SEREMU_INTERFACE
    -I../Common
upload_protocol = custom
upload_command = python flash_all.py